begin pgp signed message freebsd sa nfs security advisory freebsd project topic bug nfs server code allows remote denial service category core module nfs announced credits mike junk junk isilon com affects releases prior release stable prior correction date corrected utc releng_ utc releng__ utc releng__ utc releng__ freebsd background network file system nfs allows host export filesystems parts hosts access network mount local disks nfs built top sun remote procedure call rpc framework ii problem description part nfs server code charged handling incoming rpc messages error server received message zero length payload would cause reference payload previous message creating loop message chain would later cause infinite loop different part nfs server code tried traverse chain iii impact certain linux implementations nfs produce zero length rpc messages cases freebsd system running nfs server may lock clients connect attacker position send rpc messages affected freebsd system construct sequence malicious rpc messages cause target system lock iv workaround disable nfs server set nfs_server_enable variable etc rc conf reboot alternatively active nfs clients listed showmount utility killing mountd nfsd processes suffice add firewall rules block rpc traffic nfs server untrusted hosts solution following patch verified apply freebsd systems download relevant patch location verify detached pgp signature using pgp utility fetch ftp fetch ftp apply patch cd usr src patch path patch recompile kernel modules described url reboot system vi correction details following list contains revision numbers file corrected freebsd path revision branch src sys nfs nfs_socket releng_ releng__ releng__ releng__ begin pgp signature version gnupg freebsd ylhty end pgp signature 