matters gmbh security advisory advisory remote compromise dos vulnerability php release date last modified author stefan esser esser matters de application php severity vulnerability within multipart form data handler could allow remote compromise web server risk critical vendor status patches released reference overview discovered serious vulnerability within default version php depending processor architecture may possible remote attacker either crash compromise web server details php introduced completely rewritten multipart form data post handler working code role php developer found bug within way mime headers processed malformed post request trigger error condition correctly handled due bug could happen uninit ialised struct gets appended linked list mime headers lists gets cleaned destroyed php tries free pointers expected struct lack initialisation pointers contain stuff left stack previous function calls architecture aka possible control end uninitialised struct stack layout possible code paths leave illegal addresses within struct php crash tries free unfortunately situation absolutely different look solaris sparc installation possible attacker free chunks memory full control probably case several non architectures please note exploitability limited systems running malloc free implementations known vulnerable control structure overwrites internal php memory managment implements linked list system used overwrite nearly arbitrary memory addresses proof concept matters going release exploit vulnerability public vendor response july updated version php fixes vulnerability released downloaded vendor announcement available recommendation running php upgrade soon possible especially server runs non cpu cannot upgrade whatever reason way workaround disable kinds post requests server gpg key pub matters gmbh securityteam key fingerprint caeb copyright stefan esser rights reserved 